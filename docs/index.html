<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Variable Selection for Heterogeneous Populations • vennLasso</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Variable Selection for Heterogeneous Populations">
<meta property="og:description" content="Provides variable selection and estimation routines for models
    with main effects stratified on multiple binary factors. The vennLasso package
    is an implementation of the method introduced in Huling, et al. (2017) &lt;doi:10.1111/biom.12769&gt;.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">vennLasso</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/using_the_vennLasso_package.pdf">Using the vennLasso Package (PDF)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaredhuling/vennLasso/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">


<div id="vennlasso" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#vennlasso" class="anchor"></a>vennLasso</h1></div>
<p>The <code>vennLasso</code> package provides methods for hierarchical variable selection for models with covariate effects stratified by multiple binary factors.</p>
<div id="installation-and-help-files" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-and-help-files" class="anchor"></a>Installation and Help Files</h2>
<p>The <code>vennLasso</code> package can be installed from CRAN using:</p>
<div class="sourceCode" id="cb1"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"vennLasso"</span>)</pre></div>
<p>The development version can be installed using the <strong>devtools</strong> package:</p>
<div class="sourceCode" id="cb2"><pre class="r"><span class="kw pkg">devtools</span><span class="kw ns">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"jaredhuling/vennLasso"</span>)</pre></div>
<p>or by cloning and building.</p>
<p>Load the <strong>vennLasso</strong> package:</p>
<div class="sourceCode" id="cb3"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">vennLasso</span>)</pre></div>
<p>Access help file for the main fitting function <code><a href="reference/vennLasso.html">vennLasso()</a></code> by running:</p>
<div class="sourceCode" id="cb4"><pre class="r">?<span class="no">vennLasso</span></pre></div>
<p>Help file for cross validation function <code><a href="reference/cv.vennLasso.html">cv.vennLasso()</a></code> can be accessed by running:</p>
<div class="sourceCode" id="cb5"><pre class="r">?<span class="no">cv.vennLasso</span></pre></div>
</div>
<div id="a-quick-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-quick-example" class="anchor"></a>A Quick Example</h2>
<p>Simulate heterogeneous data:</p>
<div class="sourceCode" id="cb6"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">100</span>)
<span class="no">dat.sim</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/genHierSparseData.html">genHierSparseData</a></span>(<span class="kw">ncats</span> <span class="kw">=</span> <span class="fl">3</span>,  <span class="co"># number of stratifying factors</span>
                             <span class="kw">nvars</span> <span class="kw">=</span> <span class="fl">25</span>, <span class="co"># number of variables</span>
                             <span class="kw">nobs</span> <span class="kw">=</span> <span class="fl">150</span>, <span class="co"># number of observations per strata</span>
                             <span class="kw">nobs.test</span> <span class="kw">=</span> <span class="fl">10000</span>,
                             <span class="kw">hier.sparsity.param</span> <span class="kw">=</span> <span class="fl">0.5</span>,
                             <span class="kw">prop.zero.vars</span> <span class="kw">=</span> <span class="fl">0.75</span>, <span class="co"># proportion of variables</span>
                                                   <span class="co"># zero for all strata</span>
                             <span class="kw">snr</span> <span class="kw">=</span> <span class="fl">0.5</span>,  <span class="co"># signal-to-noise ratio</span>
                             <span class="kw">family</span> <span class="kw">=</span> <span class="st">"gaussian"</span>)

<span class="co"># design matrices</span>
<span class="no">x</span>        <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">x</span>
<span class="no">x.test</span>   <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">x.test</span>

<span class="co"># response vectors</span>
<span class="no">y</span>        <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">y</span>
<span class="no">y.test</span>   <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">y.test</span>

<span class="co"># binary stratifying factors</span>
<span class="no">grp</span>      <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">group.ind</span>
<span class="no">grp.test</span> <span class="kw">&lt;-</span> <span class="no">dat.sim</span>$<span class="no">group.ind.test</span></pre></div>
<p>Inspect the populations for each strata:</p>
<div class="sourceCode" id="cb7"><pre class="r"><span class="fu"><a href="reference/plotVenn.html">plotVenn</a></span>(<span class="no">grp</span>)</pre></div>
<p><img src="articles/readme_figs/unnamed-chunk-7-1.png"><!-- --></p>
<p>Fit vennLasso model with tuning parameter selected with 5-fold cross validation:</p>
<div class="sourceCode" id="cb8"><pre class="r"><span class="no">fit.adapt</span> <span class="kw">&lt;-</span> <span class="fu"><a href="reference/cv.vennLasso.html">cv.vennLasso</a></span>(<span class="no">x</span>, <span class="no">y</span>,
                          <span class="no">grp</span>,
                          <span class="kw">adaptive.lasso</span> <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">nlambda</span>        <span class="kw">=</span> <span class="fl">50</span>,
                          <span class="kw">family</span>         <span class="kw">=</span> <span class="st">"gaussian"</span>,
                          <span class="kw">standardize</span>    <span class="kw">=</span> <span class="fl">FALSE</span>,
                          <span class="kw">intercept</span>      <span class="kw">=</span> <span class="fl">TRUE</span>,
                          <span class="kw">nfolds</span>         <span class="kw">=</span> <span class="fl">5</span>)</pre></div>
<p>Plot selected variables for each strata (not run):</p>
<div class="sourceCode" id="cb9"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">igraph</span>)</pre></div>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<div class="sourceCode" id="cb13"><pre class="r"><span class="fu"><a href="reference/plotSelections.html">plotSelections</a></span>(<span class="no">fit.adapt</span>)</pre></div>
<!--html_preserve-->
<div id="htmlwidget-916a5488a66ec817258c" style="width:672px;height:480px;" class="visNetwork html-widget">
</div>
<script type="application/json" data-for="htmlwidget-916a5488a66ec817258c">{"x":{"nodes":{"id":[1,2,3,5,4,6,7,8],"label":["0,0,0","0,0,1","0,1,0","1,0,0","0,1,1","1,0,1","1,1,0","1,1,1"],"value":[10,5,6,2,9,7,9,16],"title":["<p>Num vars selected: 10<\/p>","<p>Num vars selected: 5<\/p>","<p>Num vars selected: 6<\/p>","<p>Num vars selected: 2<\/p>","<p>Num vars selected: 9<\/p>","<p>Num vars selected: 7<\/p>","<p>Num vars selected: 9<\/p>","<p>Num vars selected: 16<\/p>"],"x":[-0.444444444444444,-1,-0.333333333333333,0.333333333333333,-0.666666666666667,0.333333333333333,1,0.222222222222222],"y":[-1,1,1,1,0,0,0,-1]},"edges":{"from":[4,6,4,7,8,6,7,8,8],"to":[2,2,3,3,4,5,5,6,7],"value":[5,5,6,6,9,2,2,7,9]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","mass":1,"physics":false,"font":{"size":35}},"manipulation":{"enabled":false},"edges":{"smooth":true},"physics":{"stabilization":false},"interaction":{"hover":true,"tooltipDelay":0}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"igraphlayout":{"type":"full"},"highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script><!--/html_preserve--><p>Predict response for test data:</p>
<div class="sourceCode" id="cb14"><pre class="r"><span class="no">preds.vl</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">fit.adapt</span>, <span class="no">x.test</span>, <span class="no">grp.test</span>, <span class="kw">s</span> <span class="kw">=</span> <span class="st">"lambda.min"</span>,
                    <span class="kw">type</span> <span class="kw">=</span> <span class="st">'response'</span>)</pre></div>
<p>Evaluate mean squared error:</p>
<div class="sourceCode" id="cb15"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>((<span class="no">y.test</span> - <span class="no">preds.vl</span>) ^ <span class="fl">2</span>)</pre></div>
<pre><code>## [1] 0.6852124</code></pre>
<div class="sourceCode" id="cb17"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>((<span class="no">y.test</span> - <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(<span class="no">y.test</span>)) ^ <span class="fl">2</span>)</pre></div>
<pre><code>## [1] 1.011026</code></pre>
<p>Compare with naive model with all interactions between covariates and stratifying binary factors:</p>
<div class="sourceCode" id="cb19"><pre class="r"><span class="no">df.x</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">y</span> <span class="kw">=</span> <span class="no">y</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">x</span>, <span class="kw">grp</span> <span class="kw">=</span> <span class="no">grp</span>)
<span class="no">df.x.test</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">x.test</span>, <span class="kw">grp</span> <span class="kw">=</span> <span class="no">grp.test</span>)

<span class="co"># create formula for interactions between factors and covariates</span>
<span class="no">form</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"y ~ ("</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span>(<span class="st">"x."</span>, <span class="fl">1</span>:<span class="fu"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(<span class="no">x</span>)), <span class="kw">collapse</span> <span class="kw">=</span> <span class="st">"+"</span>), <span class="st">")*(grp.1*grp.2*grp.3)"</span> )</pre></div>
<p>Fit linear model and generate predictions for test set:</p>
<div class="sourceCode" id="cb20"><pre class="r"><span class="no">lmf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span>(<span class="no">form</span>), <span class="kw">data</span> <span class="kw">=</span> <span class="no">df.x</span>)

<span class="no">preds.lm</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(<span class="no">lmf</span>, <span class="no">df.x.test</span>)</pre></div>
<p>Evaluate mean squared error:</p>
<div class="sourceCode" id="cb21"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>((<span class="no">y.test</span> - <span class="no">preds.lm</span>) ^ <span class="fl">2</span>)</pre></div>
<pre><code>## [1] 0.8056107</code></pre>
<div class="sourceCode" id="cb23"><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>((<span class="no">y.test</span> - <span class="no">preds.vl</span>) ^ <span class="fl">2</span>)</pre></div>
<pre><code>## [1] 0.6852124</code></pre>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=vennLasso">https://​cloud.r-project.org/​package=vennLasso</a>
</li>
<li>Browse source code at <br><a href="https://github.com/jaredhuling/vennLasso/">https://​github.com/​jaredhuling/​vennLasso/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jaredhuling/vennLasso/issues">https://​github.com/​jaredhuling/​vennLasso/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li>GPL (&gt;= 2)</li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing vennLasso</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jared Huling <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-0670-4845" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=vennLasso"><img src="http://www.r-pkg.org/badges/version/vennLasso" alt="version"></a></li>
<li><a href="https://travis-ci.org/jaredhuling/vennLasso"><img src="https://travis-ci.org/jaredhuling/vennLasso.svg?branch=master" alt="Build Status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
