<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Variable selection for heterogeneous populations  • vennLasso</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">vennLasso</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="articles/index.html">Articles</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jaredhuling/vennLasso">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="index_files/htmlwidgets-0.8/htmlwidgets.js"></script><link href="index_files/vis-4.20.0/vis.css" rel="stylesheet">
<script src="index_files/vis-4.20.0/vis.min.js"></script><script src="index_files/visNetwork-binding-2.0.0/visNetwork.js"></script><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<div id="vennlasso" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#vennlasso" class="anchor"></a>vennLasso</h1></div>
<p>Hierarchical variable selection for models stratified on binary factors</p>
<div id="installation-and-help-files" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-and-help-files" class="anchor"></a>Installation and Help Files</h2>
<p>Install using the <strong>devtools</strong> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"jaredhuling/vennLasso"</span>)</code></pre></div>
<p>or by cloning and building.</p>
<p>Load the <strong>vennLasso</strong> package:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(vennLasso)</code></pre></div>
<p>Access help file for the main fitting function <code><a href="reference/vennLasso.html">vennLasso()</a></code> by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="reference/vennLasso.html">?vennLasso</a></code></pre></div>
<p>Help file for cross validation function <code><a href="reference/cv.vennLasso.html">cv.vennLasso()</a></code> can be accessed by running:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><a href="reference/cv.vennLasso.html">?cv.vennLasso</a></code></pre></div>
</div>
<div id="a-quick-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-quick-example" class="anchor"></a>A Quick Example</h2>
<p>Simulate heterogeneous data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">100</span>)
dat.sim &lt;-<span class="st"> </span><span class="kw"><a href="reference/genHierSparseData.html">genHierSparseData</a></span>(<span class="dt">ncats =</span> <span class="dv">3</span>,  <span class="co"># number of stratifying factors</span>
                             <span class="dt">nvars =</span> <span class="dv">25</span>, <span class="co"># number of variables</span>
                             <span class="dt">nobs =</span> <span class="dv">150</span>, <span class="co"># number of observations per strata</span>
                             <span class="dt">nobs.test =</span> <span class="dv">10000</span>,
                             <span class="dt">hier.sparsity.param =</span> <span class="fl">0.5</span>,
                             <span class="dt">prop.zero.vars =</span> <span class="fl">0.75</span>, <span class="co"># proportion of variables</span>
                                                   <span class="co"># zero for all strata</span>
                             <span class="dt">snr =</span> <span class="fl">0.5</span>,  <span class="co"># signal-to-noise ratio</span>
                             <span class="dt">family =</span> <span class="st">"gaussian"</span>)

<span class="co"># design matrices</span>
x        &lt;-<span class="st"> </span>dat.sim$x
x.test   &lt;-<span class="st"> </span>dat.sim$x.test

<span class="co"># response vectors</span>
y        &lt;-<span class="st"> </span>dat.sim$y
y.test   &lt;-<span class="st"> </span>dat.sim$y.test

<span class="co"># binary stratifying factors</span>
grp      &lt;-<span class="st"> </span>dat.sim$group.ind
grp.test &lt;-<span class="st"> </span>dat.sim$group.ind.test</code></pre></div>
<p>Inspect the populations for each strata:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/plotVenn.html">plotVenn</a></span>(grp)</code></pre></div>
<p><img src="articles/readme_figs/unnamed-chunk-6-1.png" width="672"></p>
<p>Fit vennLasso model with tuning parameter selected with 5-fold cross validation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">fit.adapt &lt;-<span class="st"> </span><span class="kw"><a href="reference/cv.vennLasso.html">cv.vennLasso</a></span>(x, y,
                          grp,
                          <span class="dt">adaptive.lasso =</span> <span class="ot">TRUE</span>,
                          <span class="dt">nlambda        =</span> <span class="dv">50</span>,
                          <span class="dt">family         =</span> <span class="st">"gaussian"</span>,
                          <span class="dt">standardize    =</span> <span class="ot">FALSE</span>,
                          <span class="dt">intercept      =</span> <span class="ot">TRUE</span>,
                          <span class="dt">nfolds         =</span> <span class="dv">5</span>)</code></pre></div>
<p>Plot selected variables for each strata (not run):</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(igraph)</code></pre></div>
<pre><code>## 
## Attaching package: 'igraph'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     decompose, spectrum</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     union</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="reference/plotSelections.html">plotSelections</a></span>(fit.adapt)</code></pre></div>
<div id="htmlwidget-916a5488a66ec817258c" style="width:672px;height:480px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-916a5488a66ec817258c">{"x":{"nodes":{"id":[1,2,3,5,4,6,7,8],"label":["0,0,0","0,0,1","0,1,0","1,0,0","0,1,1","1,0,1","1,1,0","1,1,1"],"value":[10,5,6,2,9,7,9,16],"title":["<p>Num vars selected: 10<\/p>","<p>Num vars selected: 5<\/p>","<p>Num vars selected: 6<\/p>","<p>Num vars selected: 2<\/p>","<p>Num vars selected: 9<\/p>","<p>Num vars selected: 7<\/p>","<p>Num vars selected: 9<\/p>","<p>Num vars selected: 16<\/p>"],"x":[-0.444444444444444,-1,-0.333333333333333,0.333333333333333,-0.666666666666667,0.333333333333333,1,0.222222222222222],"y":[-1,1,1,1,0,0,0,-1]},"edges":{"from":[4,6,4,7,8,6,7,8,8],"to":[2,2,3,3,4,5,5,6,7],"value":[5,5,6,6,9,2,2,7,9]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot","mass":1,"physics":false,"font":{"size":35}},"manipulation":{"enabled":false},"edges":{"smooth":true},"physics":{"stabilization":false},"interaction":{"hover":true,"tooltipDelay":0}},"groups":null,"width":null,"height":null,"idselection":{"enabled":true,"style":"width: 150px; height: 26px","useLabels":true},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)"},"main":null,"submain":null,"footer":null,"igraphlayout":{"type":"full"},"highlight":{"enabled":true,"hoverNearest":true,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null},"tooltipStay":300,"tooltipStyle":"position: fixed;visibility:hidden;padding: 5px;white-space: nowrap;font-family: verdana;font-size:14px;font-color:#000000;background-color: #f5f4ed;-moz-border-radius: 3px;-webkit-border-radius: 3px;border-radius: 3px;border: 1px solid #808074;box-shadow: 3px 3px 10px rgba(0, 0, 0, 0.2);"},"evals":[],"jsHooks":[]}</script><p>Predict response for test data:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">preds.vl &lt;-<span class="st"> </span><span class="kw">predict</span>(fit.adapt, x.test, grp.test, <span class="dt">s =</span> <span class="st">"lambda.min"</span>,
                    <span class="dt">type =</span> <span class="st">'response'</span>)</code></pre></div>
<p>Evaluate mean squared error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((y.test -<span class="st"> </span>preds.vl) ^<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.6852124</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((y.test -<span class="st"> </span><span class="kw">mean</span>(y.test)) ^<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 1.011026</code></pre>
<p>Compare with naive model with all interactions between covariates and stratifying binary factors:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">df.x &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> y, <span class="dt">x =</span> x, <span class="dt">grp =</span> grp)
df.x.test &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x.test, <span class="dt">grp =</span> grp.test)

<span class="co"># create formula for interactions between factors and covariates</span>
form &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">"y ~ ("</span>, <span class="kw">paste</span>(<span class="kw">paste0</span>(<span class="st">"x."</span>, <span class="dv">1</span>:<span class="kw">ncol</span>(x)), <span class="dt">collapse =</span> <span class="st">"+"</span>), <span class="st">")*(grp.1*grp.2*grp.3)"</span> )</code></pre></div>
<p>Fit linear model and generate predictions for test set:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">lmf &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">as.formula</span>(form), <span class="dt">data =</span> df.x)

preds.lm &lt;-<span class="st"> </span><span class="kw">predict</span>(lmf, df.x.test)</code></pre></div>
<p>Evaluate mean squared error:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((y.test -<span class="st"> </span>preds.lm) ^<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.8056107</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">mean</span>((y.test -<span class="st"> </span>preds.vl) ^<span class="st"> </span><span class="dv">2</span>)</code></pre></div>
<pre><code>## [1] 0.6852124</code></pre>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/jaredhuling/vennLasso">https://​github.com/​jaredhuling/​vennLasso</a>
</li>
<li>Report a bug at <br><a href="https://github.com/jaredhuling/vennLasso/issues">https://​github.com/​jaredhuling/​vennLasso/​issues</a>
</li>
</ul>
<h2>License</h2>
<p>GPL (&gt;= 2)</p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Jared Huling <br><small class="roles"> Author, maintainer </small> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jared Huling.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
